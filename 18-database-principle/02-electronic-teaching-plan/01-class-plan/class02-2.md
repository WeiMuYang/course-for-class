# 02 上课计划  
---
## 1 回顾上节课  
---
```02-1
## 02-1  
1. 关系的定义(域、笛卡儿积、关系、相关术语)
2. 关系模式与关系   
3. 关系数据库  
4. 关系操作(查询、和插入、删除、修改)  5种基本操作  
5. 关系的三类完整性约束     
```

## 2 学生问题   
1. 查询的基本关系操作为什么没有交和连接   
  - 交可以通过基本操作集合差来求得   
  - 连接可以借助选择、投影和笛卡儿积求得  
2. 外连接，左外连接，右外连接的连接过程   
  - 一会儿详细讲一下   
3. 候选码或者说主码一定不能相同，其他的可以相同？  
  - 根据候选码的定义:某一属性组的值能惟一的标识一个元组,而其子集不能,决定了每个元组的候选码肯定不同   
  - 若候选码中有多个属性的话,单个属性可能有相同的,但是每个元组候选码不同   
4. 同一个关系模型的任意两个元组值(   A   )   
  - A. 不能全同  
  - B.可全同  
  - C.必须全同  
  - D.以上都不是  
5. 基本表和视图表的区别和联系  
  - 基本表是本身独立存在的表，在SQL中一个关系就对应一个表    
  - 视图是从一个或几个基本表导出的表。视图本身不存在独立存储在数据库中，是一个虚表。     
  - 数据库中只存放视图的定义而不存放视图对应的数据，这些数据仍然存放在导出视图的基本表中。   
6. 如何区分两个关系中那个是参照关系，哪个是被参照关系？   
  - 根据外码的定义：参照关系中，非主码F参照被参照关系中的主码Ks  
  - 那么如何区分主码，其实后面我们会教大家如何求主码   
  - 根据关系间的引用及现实世界中的实体间的关系     
7. 专门集合运算中，连接运算的等值连接和自然连接不大懂  
  - 一会儿详细讲一下   


## 3 本节课内容    
### 3.1 关系代数  
#### 3.1.1 传统的集合运算  
1. 集合的交集可以通过集合求差得到，因此集合求交集不是基本操作  
2. 笛卡儿积中元组的个数是两个关系基数的乘积   
#### 3.1.2 专门的集合运算  
- $ t[A_i]$则表示元组t中相应于属性$A_i$的一个分量    
- R为n目关系，S为m目关系。$t_r \in R，t_s \in S$，$\overset{\frown}{t_r t_s}$称为元组连接或元组的串接。笛卡儿积的一个元组    
- 它是一个$n+m$列的元组，前n个分量(元组的一个属性值)为R中的一个n元组，后m个分量为S中的一个m元组。   
- 象集定义为$$Z_x = \lbrace t[Z]|t \in R, t[X] =x  \rbrace$$它表示R中属性组X上的值为x的诸元素在Z上分量的集合    
1. 选择  
	- 记作$$ \sigma_F(R) = \lbrace t|t \in R  \wedge F(t ) = '真' \rbrace $$ 其中F表示选择条件，它是一个逻辑表达式，取逻辑值“真”或“假”   
	- 选择是从关系R中选取使逻辑表达式F为真的元组。**这是从行的角度进行运算**   
2. 投影  
	- 记作$$\Pi_A(R) = \lbrace t[A]|t \in R \rbrace$$其中A为R中的属性列  
	- **投影操作是从列的角度进行的运算**    
	- 但是会去除重复行(**因为关系不允许重复元组** )  
3. 连接  
	- 记作：$ \mathop{R  \bowtie S} \limits_{A \theta B} = \lbrace \overset{\frown}{t_r t_s} | t_r \in R  \wedge  t_s \in S \wedge t_r[A] \theta t_s[B] \rbrace$     
	- :pencil:从R中拿一个$t_r$和S中拿一个$t_s$，且保留满足$t_r$中的A属性和$t_s$中的B属性，满足$A \theta B$关系的元组    
	- A和B分别为R和S上列数相等的且可比的属性组，$\theta$是比较运算符。   
	- 连接运算有两种最重要也是最常用的连接   
		- 等值连接：当$ \theta$为”=“时      
		- 自然连接：一种特殊的等值连接    
			- a) 两个关系中进行比较的分量必须是同名的属性组，并且在结果中把重复的属性列去掉   
			- b) 即若R和S中具有相同的属性组B，U为R和S的全体属性集合，则自然连接记作$$R  \bowtie S = \lbrace \overset{\frown}{t_r t_s}[U-B]|t_r \in R  \wedge  t_s \in S \wedge t_r[B] = t_s[B]  \rbrace$$     
		- :pencil:因为自然连接需要去掉重复属性组，因此比较的分量必须属性名相同   
		- 一般的连接操作是从行的角度进行运算，但自然连接还需要**取消重复列(重复列保留一个属性组)**，所以**是同时从行和列的角度进行运算**    
4. 外连接与左右连接(自然连接的基础上增加悬浮元组)   
	- 关系R中某些元组有可能在S中不存在公共属性上相等的元组，从而造成R中这些元组被舍弃，或者S中某些元组被舍弃，**这些被舍弃的元组称为悬浮元组**   
	- :pencil:每个关系都加上全能空行(可以与悬浮元组配对)    
	- :pencil:外连接、左外连接和右外连接都是建立在自然连接的基础上，想把悬浮数组加进来  
		- a. 如果把悬浮元组也保存在结果关系中，而在其他属性上填空值(NULL)，那么这种连接叫做**外连接**     
		- :pencil: **外连接**增加元组个数为，R和S悬浮元组之和   
		- b. 如果只保留左边关系R中的悬浮元组就叫做**左外连接**   
		- :pencil: **左外连接**增加元组个数为，R悬浮元组个数     
		- c. 如果只保留右边关系R中的悬浮元组就叫做**右外连接**  
		- :pencil: **右外连接**增加元组个数为，S悬浮元组个数       
5. 除运算   
	- 关系R除以关系S的结果为关系T，则**T包含所有在R但不在S中的属性及其值，且T的元组与S的元组的所有组合都在R中。**    
	- :pencil:根据除运算的定义，**除的结果T包含所有在$R(X,Y)$但不在$S(Y,Z)$中的属性及其值**：决定了结果T中的属性是$X$   
	- :pencil:**T的元组与S中的元组的所有组合都在R中**：决定了$\Pi_{X,Y}(T \times S)  \subseteq  R$    
	- :pencil:$Z$属性可有可无对结果不会产生影响     
	- :pencil:快速算法：   
		- i. 先确定R和S中的属性组$X,Y,Z$   
		- ii. 因为结果T中只包含属性$X$，因此确定T中属性   
		- iii. 在R中找属性$X$所有取值，根据取值的对应的$Y$是否**都在**S中属性$Y$出现：  
		- a)若都出现在S的$Y$中，那么将该$X$属性值填入T中     
		- b)若有一个未出现在S的$Y$中，那么该$X$属性值舍弃    
6. 关于SQLServer安装   
	- SQLServer2008 首选   
	- SQLServer2014 次之  
	- 虚拟机再次   


## 4 课下要求  
1. 结合PPT看课本  
2. 发下去练习册好好做一下，有问题及时沟通，问得多的统一直播答疑  
3. **雪梨任务认真做，别忘了提交 **  
4. 遇到问题及时向学委反馈，我会根据课表时间答疑    
5. 下节课提问没看直播的学生  
6. **周五下午直播答疑**   




